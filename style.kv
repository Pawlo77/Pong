<OptionButton@Button>:
    background_color: (0, 0, 0, 0)
    font_size: self.height / 2

    canvas.before:
        Color: 
            rgba: (255, 255, 255, 1)
        Line:
            width: self.height / 40
            rectangle: self.x, self.y, self.width, self.height

<BoxLayout>:
    orientation: "vertical"

<Rectangle>:
    Color:
        rgba: (255, 0, 0, 0)

<Paddle>:
    canvas:
        Color:
            rgba: self.color
        Rectangle:
            pos: self.pos
            size: self.size

<NameLabel@Label>
    size_hint: (0.2, 0.1)
    valign: "middle"
    text_size: self.size
    font_size: self.height / 2

<ScoreLabel@Label>:
    font_size: root.height / 15

<MenuScreen>:
    Label:
        text: "MENU"
        font_size: root.height / 8
        pos_hint: {"center_x": 0.5, "center_y": 0.8}

    BoxLayout:
        size_hint: 0.8, 0.5
        pos_hint: {"center_x": 0.5, "y": 0.1}
        spacing: self.height / 20
        
        OptionButton:
            text: "Play alone"
            on_press:
                root.manager.transition.duration = root.settings.transition_duration
                root.manager.transition.direction = "up"
                root.manager.current = "game"
                root.manager.current_screen.set_up("solo")

        OptionButton: 
            text: "Play with friends"
            on_press:
                root.manager.transition.duration = root.settings.transition_duration
                root.manager.transition.direction = "left"
                root.manager.current = "connect"
    
        OptionButton: 
            text: "Stats"
            on_press:
                root.manager.transition.duration = root.settings.transition_duration
                root.manager.transition.direction = "right"
                root.manager.current = "stats"

        OptionButton: 
            text: "Exit"
            on_press:
                exit(0)


<GameScreen>:
    player1: player1
    player2: player2
    ball: ball

    canvas:
        Color:
            rgba: (255, 255, 255, 0.8)
        Rectangle:
            pos: root.center_x - root.width / 200, 0
            size: root.width / 100, root.height * 0.4
        Rectangle:  
            pos: root.center_x - root.width / 200, self.height * 0.6
            size: root.width / 100, root.height * 0.25

    NameLabel:
        halign: "left"
        pos_hint: {"x": 0.02, "top": 0.98}
        text: player1.name if len(player1.name) < 8 else player1.name[:8] + "..."
        color: player1.color

    NameLabel:
        halign: "right"
        pos_hint: {"right": 0.98, "top": 0.98}
        text: player2.name if len(player2.name) < 8 else player2.name[:8] + "..."
        color: player2.color

    ScoreLabel:
        pos_hint: {"center_x": 0.25, "center_y": 0.9}
        text: str(player1.score)
        color: player1.color

    ScoreLabel:
        pos_hint: {"center_x": 0.75, "center_y": 0.9}
        text: str(player2.score)
        color: player2.color

    Label:
        id: streak
        color: "red" if root.cc else "white"
        font_size: root.height / 10
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        text: str(root.streak)

    Paddle:
        id: player1
        center_y: root.center_y
        x: self.width / 2
        size_hint: 0.02, 0.33
        
    Paddle:
        id: player2
        center_y: root.center_y
        right: root.right - self.width / 2
        size_hint: 0.02, 0.33

    Ball:
        id: ball
        canvas:
            Color:
                rgba: (255, 255, 255, 1) if root.gg else (255, 255, 255, 0)
            Ellipse:
                pos: self.pos
                size: self.size
        size_hint: None, None
        size: root.height / 20, root.height / 20

    Button:
        canvas.before: 
            Color:
                rgba: (255, 255, 255, 1)
            RoundedRectangle:
                pos: root.center_x - root.height / 22,  0.879 * root.height, 
                size: root.height / 11, root.height / 11  
                radius: [self.width / 2,]

            Color:
                rgba: (0, 0, 0, 1)
            RoundedRectangle:
                pos: root.center_x - root.height / 24,  0.8825 * root.height, 
                size: root.height / 12, root.height / 12
                radius: [self.width / 2,]

        background_color: (0, 0, 0, 0)
        font_size: root.height / 14
        pos_hint: {"center_x": 0.5, "center_y": 0.925}
        size_hint: (0.065, 0.075)
        text: "i"
        on_press:
            root.pause()
            root.manager.transition.duration = 0
            root.manager.current = "pause"


<PauseScreen>:
    Label:
        text: "Game Paused"
        font_size: root.height / 8
        pos_hint: {"center_x": 0.5, "center_y": 0.8}

    BoxLayout:
        size_hint: 0.6, 0.4
        pos_hint: {"center_x": 0.5, "y": 0.2}
        spacing: self.height / 10

        OptionButton:
            text:
                "Resume"
            on_press:
                root.manager.transition.duration = 0
                root.manager.current = "game"
                root.manager.get_screen("game").start_countdown(root.manager.get_screen("game").unpause)

        OptionButton:
            text:
                "Go to menu"
            on_press:
                root.manager.transition.duration = root.settings.transition_duration
                root.manager.transition.direction = "right"
                root.manager.current = "menu"
                root.manager.get_screen("game").reset()

        OptionButton:
            text: "Exit"
            on_press: exit(0)

<ConnectScreen>:
    GridLayout:
        cols: 1
        rows: 4
        spacing: root.height / 20
        padding: root.height / 5

        OptionButton:
            text: "Play on this PC"
            on_press:
                root.manager.transition.duration = root.settings.transition_duration
                root.manager.transition.direction = "up"
                root.manager.current = "game"
                root.manager.current_screen.set_up("offline")
        
        OptionButton:
            text: "Host game"
        
        OptionButton:
            text: "Join game"

        OptionButton:
            text: "Go back"
            on_press:
                root.manager.transition.duration = root.settings.transition_duration
                root.manager.transition.direction = "right"
                root.manager.current = "menu"